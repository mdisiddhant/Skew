<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Advanced Fabric Skew Calculator</title>
  <style>
    :root {
      --primary: #4a6fa5;
      --secondary: #166088;
      --accent: #4fc3f7;
      --error: #e74c3c;
      --success: #2ecc71;
      --text: #333;
      --light: #f8f9fa;
      --dark: #343a40;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      text-align: center;
      padding: 20px;
      min-height: 100vh;
      color: var(--text);
    }
    
    .container {
      background: white;
      padding: 30px;
      border-radius: 15px;
      max-width: 500px;
      margin: 20px auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
    
    .container:hover {
      transform: translateY(-5px);
    }
    
    h2 {
      color: var(--primary);
      margin-bottom: 25px;
      font-size: 28px;
      position: relative;
      padding-bottom: 10px;
    }
    
    h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: var(--accent);
    }
    
    .input-group {
      margin-bottom: 20px;
      text-align: left;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--secondary);
    }
    
    input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.3s;
      box-sizing: border-box;
    }
    
    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.2);
      outline: none;
    }
    
    button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 25px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
      width: 100%;
      margin-top: 10px;
    }
    
    button:hover {
      background: var(--secondary);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .result-container {
      margin-top: 30px;
      padding: 20px;
      border-radius: 8px;
      background: var(--light);
      display: none;
    }
    
    .result {
      font-size: 24px;
      font-weight: bold;
      color: var(--success);
      margin: 10px 0;
    }
    
    .interpretation {
      font-size: 16px;
      color: var(--dark);
      margin-top: 10px;
    }
    
    .history {
      margin-top: 30px;
      text-align: left;
      border-top: 1px solid #eee;
      padding-top: 20px;
    }
    
    .history h3 {
      color: var(--secondary);
      margin-bottom: 15px;
    }
    
    .history-list {
      max-height: 200px;
      overflow-y: auto;
      padding: 10px;
      background: var(--light);
      border-radius: 8px;
    }
    
    .history-item {
      padding: 8px 0;
      border-bottom: 1px solid #ddd;
      display: flex;
      justify-content: space-between;
    }
    
    .history-item:last-child {
      border-bottom: none;
    }
    
    .error {
      color: var(--error);
      font-size: 14px;
      margin-top: 5px;
      display: none;
    }
    
    .tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #ddd;
    }
    
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      background: #f1f1f1;
      border: none;
      border-radius: 5px 5px 0 0;
      margin-right: 5px;
    }
    
    .tab.active {
      background: var(--primary);
      color: white;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    @media (max-width: 600px) {
      .container {
        padding: 20px;
      }
      
      h2 {
        font-size: 24px;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Advanced Fabric Skew Calculator</h2>
  
  <div class="tabs">
    <button class="tab active" onclick="openTab('skew')">Skew Calculator</button>
    <button class="tab" onclick="openTab('bias')">Bias Calculator</button>
  </div>
  
  <div id="skew" class="tab-content active">
    <div class="input-group">
      <label for="width">Fabric Width (inches)</label>
      <input type="number" id="width" placeholder="Enter fabric width" step="0.01" min="0.01">
      <div id="width-error" class="error">Please enter a valid width</div>
    </div>
    
    <div class="input-group">
      <label for="deviation">Deviation (inches)</label>
      <input type="number" id="deviation" placeholder="Enter deviation measurement" step="0.01">
      <div id="deviation-error" class="error">Please enter a valid deviation</div>
    </div>
    
    <button onclick="calculateSkew()">Calculate Skew Percentage</button>
    
    <div class="result-container" id="skew-result">
      <div class="result" id="skew-value"></div>
      <div class="interpretation" id="skew-interpretation"></div>
    </div>
  </div>
  
  <div id="bias" class="tab-content">
    <div class="input-group">
      <label for="fabric-length">Fabric Length (inches)</label>
      <input type="number" id="fabric-length" placeholder="Enter fabric length" step="0.01" min="0.01">
      <div id="length-error" class="error">Please enter a valid length</div>
    </div>
    
    <div class="input-group">
      <label for="bias-width">Bias Width (inches)</label>
      <input type="number" id="bias-width" placeholder="Enter bias width" step="0.01" min="0.01">
      <div id="bias-error" class="error">Please enter a valid width</div>
    </div>
    
    <button onclick="calculateBias()">Calculate Bias Yield</button>
    
    <div class="result-container" id="bias-result">
      <div class="result" id="bias-value"></div>
      <div class="interpretation" id="bias-interpretation"></div>
    </div>
  </div>
  
  <div class="history">
    <h3>Calculation History</h3>
    <div class="history-list" id="history-list">
      <!-- History items will be added here -->
    </div>
    <button onclick="clearHistory()" style="margin-top: 10px; background: var(--error);">Clear History</button>
  </div>
</div>

<script>
  // Initialize history from localStorage
  let calculationHistory = JSON.parse(localStorage.getItem('fabricCalcHistory')) || [];
  updateHistoryDisplay();
  
  function openTab(tabName) {
    // Hide all tab contents
    const tabContents = document.getElementsByClassName('tab-content');
    for (let i = 0; i < tabContents.length; i++) {
      tabContents[i].classList.remove('active');
    }
    
    // Deactivate all tabs
    const tabs = document.getElementsByClassName('tab');
    for (let i = 0; i < tabs.length; i++) {
      tabs[i].classList.remove('active');
    }
    
    // Activate selected tab
    document.getElementById(tabName).classList.add('active');
    event.currentTarget.classList.add('active');
  }
  
  function calculateSkew() {
    // Reset errors
    document.getElementById('width-error').style.display = 'none';
    document.getElementById('deviation-error').style.display = 'none';
    
    // Get values
    const width = parseFloat(document.getElementById('width').value);
    const deviation = parseFloat(document.getElementById('deviation').value);
    
    // Validate
    let isValid = true;
    if (isNaN(width) || width <= 0) {
      document.getElementById('width-error').style.display = 'block';
      isValid = false;
    }
    if (isNaN(deviation)) {
      document.getElementById('deviation-error').style.display = 'block';
      isValid = false;
    }
    if (!isValid) return;
    
    // Calculate
    const skew = (deviation / width) * 100;
    const resultContainer = document.getElementById('skew-result');
    const resultElement = document.getElementById('skew-value');
    const interpretationElement = document.getElementById('skew-interpretation');
    
    resultElement.textContent = `Skew Percentage: ${skew.toFixed(2)}%`;
    
    // Provide interpretation
    let interpretation = '';
    if (skew < 1) {
      interpretation = 'Excellent - Minimal skew, fabric is very straight.';
    } else if (skew < 3) {
      interpretation = 'Good - Acceptable skew for most applications.';
    } else if (skew < 5) {
      interpretation = 'Fair - May require correction for precision work.';
    } else {
      interpretation = 'Poor - Significant skew, likely needs correction.';
    }
    
    interpretationElement.textContent = interpretation;
    resultContainer.style.display = 'block';
    
    // Add to history
    addToHistory({
      type: 'Skew',
      width: width,
      deviation: deviation,
      result: skew,
      date: new Date().toLocaleString()
    });
  }
  
  function calculateBias() {
    // Reset errors
    document.getElementById('length-error').style.display = 'none';
    document.getElementById('bias-error').style.display = 'none';
    
    // Get values
    const length = parseFloat(document.getElementById('fabric-length').value);
    const width = parseFloat(document.getElementById('bias-width').value);
    
    // Validate
    let isValid = true;
    if (isNaN(length) || length <= 0) {
      document.getElementById('length-error').style.display = 'block';
      isValid = false;
    }
    if (isNaN(width) || width <= 0) {
      document.getElementById('bias-error').style.display = 'block';
      isValid = false;
    }
    if (!isValid) return;
    
    // Calculate
    const biasLength = Math.sqrt(Math.pow(length, 2) + Math.pow(width, 2));
    const resultContainer = document.getElementById('bias-result');
    const resultElement = document.getElementById('bias-value');
    const interpretationElement = document.getElementById('bias-interpretation');
    
    resultElement.textContent = `Bias Length: ${biasLength.toFixed(2)} inches`;
    
    // Provide interpretation
    interpretationElement.textContent = `For a fabric piece ${length.toFixed(2)}" long and ${width.toFixed(2)}" wide, the bias cut length is ${biasLength.toFixed(2)} inches.`;
    resultContainer.style.display = 'block';
    
    // Add to history
    addToHistory({
      type: 'Bias',
      length: length,
      width: width,
      result: biasLength,
      date: new Date().toLocaleString()
    });
  }
  
  function addToHistory(calculation) {
    calculationHistory.unshift(calculation); // Add to beginning of array
    if (calculationHistory.length > 10) {
      calculationHistory = calculationHistory.slice(0, 10); // Keep only last 10
    }
    localStorage.setItem('fabricCalcHistory', JSON.stringify(calculationHistory));
    updateHistoryDisplay();
  }
  
  function updateHistoryDisplay() {
    const historyList = document.getElementById('history-list');
    historyList.innerHTML = '';
    
    if (calculationHistory.length === 0) {
      historyList.innerHTML = '<div style="padding: 10px; color: #666;">No calculations yet</div>';
      return;
    }
    
    calculationHistory.forEach(item => {
      const historyItem = document.createElement('div');
      historyItem.className = 'history-item';
      
      let details = '';
      if (item.type === 'Skew') {
        details = `Skew: ${item.width}" width, ${item.deviation}" dev → ${item.result.toFixed(2)}%`;
      } else {
        details = `Bias: ${item.length}" × ${item.width}" → ${item.result.toFixed(2)}"`;
      }
      
      historyItem.innerHTML = `
        <span>${details}</span>
        <small style="color: #666;">${item.date}</small>
      `;
      historyList.appendChild(historyItem);
    });
  }
  
  function clearHistory() {
    if (confirm('Are you sure you want to clear all history?')) {
      calculationHistory = [];
      localStorage.removeItem('fabricCalcHistory');
      updateHistoryDisplay();
    }
  }
  
  // Allow pressing Enter key to calculate
  document.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
      const activeTab = document.querySelector('.tab-content.active').id;
      if (activeTab === 'skew') {
        calculateSkew();
      } else {
        calculateBias();
      }
    }
  });
</script>

</body>
</html>
